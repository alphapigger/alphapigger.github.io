---
title: 聊一聊goroutine stack
tags:
  - go
  - goroutine
  - stack
categories:
  - go
abbrlink: 2d571d09
date: 2017-07-29 17:48:51
---

> 推送在外卖订餐中扮演着很重要的角色，为商家实时接单、骑手实时派单提供基础的数据通道。早期推送是由第三方服务商提供
的，随着业务复杂度的提升、订单量和用户数的持续增长，之前的系统已经远远不能满足需求，构建一个高性能、高可用的推送系统
势在必行。上半年我们用`go`开发了一个`hybrid push`服务，用户在线通过长连接下发消息，不在线借助厂商或第三方下发消息，在
构建过程中遇到了些与`routine stack`相关的问题，这里就和大家扯一扯。

带着问题阅读，才能让阅读更加高效，首先让我们看下问题:

1. *goroutine stack多大呢？是固定的还是动态变化的呢?*
2. *stack动态变化的话，什么时候扩容和缩容呢?*
3. *扩容和缩容是如何实现的呢? 对服务有什么影响吗?*

问题明确了，我们就开始往下扯呗。

## 栈大小

为了能够清晰的描述goroutine stack和传统程序栈的区别，我们先看下Linux进程内存布局:

